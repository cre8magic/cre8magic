{"version":3,"file":"ambient.js","sources":["../src/scripts/shared/constants.ts","../src/scripts/ambient/mail-encrypt.ts","../src/scripts/ambient/menu.ts","../src/scripts/ambient/breadcrumbs.ts","../src/scripts/ambient/pdf-in-new-window.ts","../src/scripts/ambient/to-top.ts","../src/scripts/ambient/gtm.ts","../src/scripts/ambient/background.ts"],"sourcesContent":["\r\nexport const debug = true;\r\nexport const debugDetailed = debug && false;\r\n\r\nexport const prefix = 'theme';\r\nexport const prefixBreadcrumbs = `${prefix}-breadcrumbs`;\r\nexport const prefixLanguages = `${prefix}-languages`;","import { debug } from '../shared/constants';\r\n\r\nexport function initMailDecrypt() {\r\n\r\n  if (debug) console.log('initMailDecrypt');\r\n\r\n  /* mailencrypting */\r\n  setTimeout(function () {\r\n    const mailElements = document.querySelectorAll('[data-madr1]:not(.madr-done)');\r\n    (Array.from(mailElements) as HTMLElement[]).forEach((mail, index) => {\r\n      const maddr = mail.getAttribute('data-madr1') + '@' + mail.getAttribute('data-madr2') + '.' + mail.getAttribute('data-madr3');\r\n      const linktext = mail.getAttribute('data-linktext') ? mail.getAttribute('data-linktext') : maddr;\r\n\r\n      const a = document.createElement('a');\r\n      a.setAttribute('href', `mailto:${maddr}`);\r\n      // Ensure linktext is defined (fall back to an empty string if null)\r\n      a.innerHTML = linktext || '';\r\n\r\n      if (mail.parentElement) mail.parentElement.appendChild(a);\r\n      mail.classList.add('madr-done');\r\n      mail.style.display = 'none';\r\n    });\r\n  }, 500);\r\n}","import { debug } from '../shared/constants';\r\n\r\ndeclare const bootstrap: any;\r\n\r\n// Takes care of closing the offcanvas when clicking on a navigation link\r\n// The page is not reloaded, so the offcanvas does not close\r\nexport function initOffCanvasEvents() {\r\n\r\n  if (debug) console.log('initOffCanvasEvents');\r\n\r\n  //Offcanvas close on link click\r\n  var navLinks = document.querySelectorAll(\".mobile-navigation-link\");\r\n  var navOffcanvas = document.getElementById('offcanvasNavbar')\r\n  if (navOffcanvas) {\r\n    var bsNavOffcanvas = new bootstrap.Offcanvas(navOffcanvas)\r\n    navLinks.forEach(element => {\r\n      element.addEventListener('click', () => {\r\n        bsNavOffcanvas.hide();\r\n      })\r\n    });\r\n  }\r\n}\r\n","import { prefix, debug, prefixBreadcrumbs } from '../shared/constants';\r\n\r\nexport function initBreadcrumb() {\r\n  if (debug) console.log(\"init breadcrumbs\");\r\n\r\n  setBreadcrumbsStyling() \r\n  window.addEventListener(\"resize\", setBreadcrumbsStyling);\r\n  document.addEventListener('scroll', setBreadcrumbsStyling);\r\n\r\n  var breadCrumbTrigger = document.querySelector(`.${prefixBreadcrumbs}-trigger`);\r\n  if (breadCrumbTrigger != null) {\r\n    breadCrumbTrigger.addEventListener('click', () => {\r\n      const selected = document.querySelector(`.${prefixBreadcrumbs}`);\r\n      if (debug) console.log(selected)\r\n      selected?.classList.toggle(`${prefixBreadcrumbs}-open`)\r\n    })\r\n  }\r\n}\r\n\r\nfunction setBreadcrumbsStyling() {\r\n  console.log(\"test 2dm 2024-11-25b\");\r\n\r\n  var header = document.getElementById(`${prefix}-page-navigation`);\r\n  if (header != null) {\r\n    var headerHeight = header.offsetHeight;\r\n\r\n    var breadcrumb = document.querySelector(`.${prefixBreadcrumbs}`) as HTMLElement;\r\n\r\n    if (!breadcrumb)\r\n      return;\r\n    breadcrumb.style.top = headerHeight + \"px\";\r\n    var breadcrumbOffsetTop = breadcrumb.getBoundingClientRect().top;\r\n\r\n    if (breadcrumbOffsetTop <= headerHeight && scrollY != 0) {\r\n      breadcrumb.classList.add(\"bg-light\", \"shadow\");\r\n    } else {\r\n      breadcrumb.classList.remove(\"bg-light\", \"shadow\");\r\n    }\r\n  }\r\n}\r\n","\r\n// TODO: THIS PROBABLY doesn't work reliably, as it would need to be called again when the page changes\r\n// will probably need to be moved to the interop and called on every reload\r\n// or use a timeout similar to mail-decrypt\r\n\r\n/* Open all PDF links in a new window */\r\nexport function openPdfInNewWindow() {\r\n  document.querySelectorAll('a').forEach((linkElem: Element, index) => {\r\n    if (linkElem.hasAttribute('href') && linkElem.getAttribute('href')?.endsWith('.pdf'))\r\n      linkElem.setAttribute('target', '_blank');\r\n  });\r\n}","import { debug, debugDetailed, prefix } from '../shared/constants';\r\n\r\nconst toTopElementId = `${prefix}-to-top`;\r\nconst visibleClass = `visible`;\r\n\r\nexport function initToTop() {\r\n  console.log('init to top');\r\n  toTopShowHideOnScroll();\r\n}\r\n\r\nfunction toTopShowHideOnScroll() {\r\n  if (debug) console.log('toTopShowHideOnScroll');\r\n  document.addEventListener(\"scroll\", toTopButtonVisibility);\r\n}\r\n\r\nfunction toTopButtonVisibility() {\r\n  var toTopButton = document.getElementById(toTopElementId);\r\n  if (!toTopButton) return;\r\n\r\n  // Ensure it has the event listener\r\n  toTopButton.addEventListener(\"click\", scrollTop);\r\n\r\n  // Todo: unsure why it does body + documentElement...\r\n  const show = document.body.scrollTop > 200 || document.documentElement.scrollTop > 200;\r\n  if (debugDetailed) console.log('to-top' + show ? \"show\" : \"hide\");\r\n  toTopButton.classList.toggle(visibleClass, show);\r\n}\r\n\r\nfunction scrollTop() {\r\n  window.scrollTo({ top: 0, behavior: 'smooth' });\r\n}","import { debug } from '../shared/constants';\r\n\r\n// Temporary solution to add GTM, not final!\r\nconst debugGtm = debug || true;\r\n\r\nfunction activateGtm(gtmKey: string) {\r\n  if (debugGtm) console.log('2dm test activate GTM');\r\n// <!-- Google Tag Manager -->\r\n// <script>\r\n(function(w,d,s,l,i){\r\n  (w as any)[l] = (w as any)[l] || [];\r\n  (w as any)[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});\r\n  var f=d.getElementsByTagName(s)[0],\r\n  j=d.createElement(s) as HTMLScriptElement,dl=l!='dataLayer'?'&l='+l:'';\r\n  j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;\r\n  f.parentNode!.insertBefore(j,f);\r\n})(window,document,'script','dataLayer',gtmKey);\r\n// </script> jjjj\r\n// <!-- End Google Tag Manager -->\r\n}\r\n\r\nclass GtmInterop {\r\n  activate = activateGtm;\r\n  pageView() {\r\n    if (debugGtm) console.log('gtm-interop - track page view');\r\n    gtag('event', 'blazor_page_view');//\r\n  }\r\n}\r\n\r\nwindow.dataLayer = window.dataLayer || [];\r\nfunction gtag(target: 'event', more: unknown) {\r\n  if (debug) console.log('gtm - gtag');\r\n  window.dataLayer.push(arguments);\r\n}\r\n\r\ndeclare global {\r\n  interface Window {\r\n    cre8magic: { gtm: GtmInterop },\r\n    dataLayer: unknown[],\r\n    gtag(): void,\r\n  }\r\n}\r\n\r\nexport function buildCre8magicGtm() {\r\n  window.cre8magic = window.cre8magic || {};\r\n  window.cre8magic.gtm = window.cre8magic.gtm || new GtmInterop();\r\n  window.gtag = window.gtag || gtag;\r\n}","import { debug, prefix } from './../shared/constants';\r\nimport { initMailDecrypt } from './mail-encrypt';\r\nimport { initOffCanvasEvents } from './menu';\r\nimport { initBreadcrumb } from './breadcrumbs';\r\nimport { openPdfInNewWindow } from './pdf-in-new-window';\r\nimport { initToTop } from './to-top';\r\nimport { buildCre8magicGtm } from './gtm';\r\n\r\ninitToTop();\r\n\r\nopenPdfInNewWindow();\r\n\r\ninitMailDecrypt();\r\n\r\ninitBreadcrumb();\r\n\r\ninitOffCanvasEvents();\r\n\r\nbuildCre8magicGtm();\r\nwindow.cre8magic.gtm.activate('GTM-T8W5TBL');"],"names":["prefix","prefixBreadcrumbs","initMailDecrypt","mailElements","mail","index","maddr","linktext","initOffCanvasEvents","navLinks","navOffcanvas","bsNavOffcanvas","element","initBreadcrumb","setBreadcrumbsStyling","breadCrumbTrigger","selected","header","headerHeight","breadcrumb","breadcrumbOffsetTop","openPdfInNewWindow","linkElem","_a","toTopElementId","visibleClass","initToTop","toTopShowHideOnScroll","toTopButtonVisibility","toTopButton","scrollTop","show","activateGtm","gtmKey","w","d","s","l","i","f","j","dl","GtmInterop","gtag","target","more","buildCre8magicGtm"],"mappings":"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"}